generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  ADMIN
}

model User {
  id                        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                      String     @db.VarChar(50)
  email                     String     @db.VarChar(255) @unique
  password                  String     @db.VarChar(100)
  role                      Role       @default(USER)
  products                  Product[]
  cartItems                 CartItem[]
  createdAt                 DateTime   @default(now()) @db.Timestamp(6)
  updatedAt                 DateTime   @updatedAt
}

model Product {
  id                        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title                     String     @db.VarChar(50)
  description               String     @db.VarChar(255)
  price                     Decimal    @db.Decimal(10, 2)
  ownerId                   String     @db.Uuid
  owner                     User       @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  cartItems                 CartItem[]
  createdAt                 DateTime   @default(now()) @db.Timestamp(6)
  updatedAt                 DateTime   @updatedAt
}

model CartItem {
  id                        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId                    String     @db.Uuid
  productId                 String     @db.Uuid
  quantity                  Int        @default(1)
  user                      User       @relation(fields: [userId], references: [id])
  product                   Product    @relation(fields: [productId], references: [id])
  createdAt                 DateTime   @default(now()) @db.Timestamp(6)
  updatedAt                 DateTime   @updatedAt

  @@unique([userId, productId])
}